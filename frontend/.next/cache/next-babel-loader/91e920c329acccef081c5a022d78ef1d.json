{"ast":null,"code":"import _Reflect$construct from \"@babel/runtime-corejs2/core-js/reflect/construct\";\nimport _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"C:\\\\Users\\\\Michael\\\\Documents\\\\reactJS\\\\stax-of-stories\\\\stax-shop\\\\Advanced-React\\\\stax\\\\frontend\\\\components\\\\Search.js\";\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = _Reflect$construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false; if (_Reflect$construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(_Reflect$construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n\\tquery SEARCH_ITEMS_QUERY($searchTerm: String!) {\\n\\t\\titems(where: { OR: [{ title_contains: $searchTerm }, { ageRange_contains: $searchTerm }] }) {\\n\\t\\t\\tid\\n\\t\\t\\timage\\n\\t\\t\\ttitle\\n\\t\\t\\tageRange\\n\\t\\t}\\n\\t}\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React from 'react';\nimport Link from 'next/link';\nimport Downshift, { resetIdCounter } from 'downshift';\nimport Router from 'next/router';\nimport { ApolloConsumer } from 'react-apollo';\nimport gql from 'graphql-tag';\nimport debounce from 'lodash.debounce';\nimport { DropDown, DropDownItem, SearchStyles } from './styles/DropDown';\nvar SEARCH_ITEMS_QUERY = gql(_templateObject());\n\nfunction routeToItem(item) {\n  Router.push({\n    pathname: '/item',\n    query: {\n      id: item.id\n    }\n  });\n}\n\nvar AutoComplete = /*#__PURE__*/function (_React$Component) {\n  _inherits(AutoComplete, _React$Component);\n\n  var _super = _createSuper(AutoComplete);\n\n  function AutoComplete() {\n    var _this;\n\n    _classCallCheck(this, AutoComplete);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      items: [],\n      loading: false\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChange\", debounce( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e, client) {\n        var res;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // turn loading on\n                _this.setState({\n                  loading: true\n                }); // Manually query apollo client\n\n\n                _context.next = 3;\n                return client.query({\n                  query: SEARCH_ITEMS_QUERY,\n                  variables: {\n                    searchTerm: e.target.value\n                  }\n                });\n\n              case 3:\n                res = _context.sent;\n\n                _this.setState({\n                  items: res.data.items,\n                  loading: false\n                });\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }(), 350));\n\n    return _this;\n  }\n\n  _createClass(AutoComplete, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      resetIdCounter();\n      return /*#__PURE__*/React.createElement(SearchStyles, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 4\n        }\n      }, /*#__PURE__*/React.createElement(Downshift, {\n        onChange: routeToItem,\n        itemToString: function itemToString(item) {\n          return item === null ? '' : item.title;\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 5\n        }\n      }, function (_ref2) {\n        var getInputProps = _ref2.getInputProps,\n            getItemProps = _ref2.getItemProps,\n            isOpen = _ref2.isOpen,\n            inputValue = _ref2.inputValue,\n            highlightedIndex = _ref2.highlightedIndex;\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 5\n          }\n        }, /*#__PURE__*/React.createElement(ApolloConsumer, {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 6\n          }\n        }, function (client) {\n          return /*#__PURE__*/React.createElement(\"input\", _extends({}, getInputProps({\n            type: 'search',\n            placeholder: \"Search for a book title or age...\",\n            id: 'search',\n            className: _this2.state.loading ? 'loading' : '',\n            onChange: function onChange(e) {\n              e.persist();\n\n              _this2.onChange(e, client);\n            }\n          }), {\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 63,\n              columnNumber: 8\n            }\n          }));\n        }), isOpen && /*#__PURE__*/React.createElement(DropDown, {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 7\n          }\n        }, _this2.state.items.map(function (item, index) {\n          return /*#__PURE__*/React.createElement(DropDownItem, _extends({}, getItemProps({\n            item: item\n          }), {\n            key: item.id,\n            highlighted: index === highlightedIndex,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 82,\n              columnNumber: 9\n            }\n          }), /*#__PURE__*/React.createElement(\"img\", {\n            width: \"50\",\n            src: item.image,\n            alt: item.title,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 88,\n              columnNumber: 10\n            }\n          }), item.title, \" - Age \", item.ageRange);\n        }), !_this2.state.items.length && !_this2.state.loading && /*#__PURE__*/React.createElement(DropDownItem, {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 32\n          }\n        }, \"Nothing Found \", inputValue)));\n      }));\n    }\n  }]);\n\n  return AutoComplete;\n}(React.Component);\n\nexport default AutoComplete;","map":{"version":3,"sources":["C:/Users/Michael/Documents/reactJS/stax-of-stories/stax-shop/Advanced-React/stax/frontend/components/Search.js"],"names":["React","Link","Downshift","resetIdCounter","Router","ApolloConsumer","gql","debounce","DropDown","DropDownItem","SearchStyles","SEARCH_ITEMS_QUERY","routeToItem","item","push","pathname","query","id","AutoComplete","items","loading","e","client","setState","variables","searchTerm","target","value","res","data","title","getInputProps","getItemProps","isOpen","inputValue","highlightedIndex","type","placeholder","className","state","onChange","persist","map","index","image","ageRange","length","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,WAAjB;AACA,OAAOC,SAAP,IAAoBC,cAApB,QAA0C,WAA1C;AACA,OAAOC,MAAP,MAAmB,aAAnB;AACA,SAASC,cAAT,QAA+B,cAA/B;AACA,OAAOC,GAAP,MAAgB,aAAhB;AACA,OAAOC,QAAP,MAAqB,iBAArB;AACA,SAASC,QAAT,EAAmBC,YAAnB,EAAiCC,YAAjC,QAAqD,mBAArD;AAIA,IAAMC,kBAAkB,GAAGL,GAAH,mBAAxB;;AAWA,SAASM,WAAT,CAAqBC,IAArB,EAA2B;AAC1BT,EAAAA,MAAM,CAACU,IAAP,CAAY;AACXC,IAAAA,QAAQ,EAAE,OADC;AAEXC,IAAAA,KAAK,EAAE;AACNC,MAAAA,EAAE,EAAEJ,IAAI,CAACI;AADH;AAFI,GAAZ;AAMA;;IAEKC,Y;;;;;;;;;;;;;;;;4DAEG;AACPC,MAAAA,KAAK,EAAE,EADA;AAEPC,MAAAA,OAAO,EAAE;AAFF,K;;+DAMGb,QAAQ;AAAA,0EAAC,iBAAOc,CAAP,EAAUC,MAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AACnB;AACA,sBAAKC,QAAL,CAAc;AAAEH,kBAAAA,OAAO,EAAE;AAAX,iBAAd,EAFmB,CAGnB;;;AAHmB;AAAA,uBAIDE,MAAM,CAACN,KAAP,CAAa;AAC9BA,kBAAAA,KAAK,EAAEL,kBADuB;AAE9Ba,kBAAAA,SAAS,EAAE;AAAEC,oBAAAA,UAAU,EAAEJ,CAAC,CAACK,MAAF,CAASC;AAAvB;AAFmB,iBAAb,CAJC;;AAAA;AAIbC,gBAAAA,GAJa;;AAQnB,sBAAKL,QAAL,CAAc;AACbJ,kBAAAA,KAAK,EAAES,GAAG,CAACC,IAAJ,CAASV,KADH;AAEbC,kBAAAA,OAAO,EAAE;AAFI,iBAAd;;AARmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAD;;AAAA;AAAA;AAAA;AAAA,SAYhB,GAZgB,C;;;;;;;6BAaV;AAAA;;AAERjB,MAAAA,cAAc;AACd,0BACC,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACC,oBAAC,SAAD;AAAW,QAAA,QAAQ,EAAES,WAArB;AAAkC,QAAA,YAAY,EAAE,sBAAAC,IAAI;AAAA,iBAAKA,IAAI,KAAK,IAAT,GAAgB,EAAhB,GAAqBA,IAAI,CAACiB,KAA/B;AAAA,SAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA,YAAEC,aAAF,SAAEA,aAAF;AAAA,YAAiBC,YAAjB,SAAiBA,YAAjB;AAAA,YAA+BC,MAA/B,SAA+BA,MAA/B;AAAA,YAAuCC,UAAvC,SAAuCA,UAAvC;AAAA,YAAmDC,gBAAnD,SAAmDA,gBAAnD;AAAA,4BACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACC,oBAAC,cAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,UAAAb,MAAM;AAAA,8BACN,0CAEKS,aAAa,CAAE;AAClBK,YAAAA,IAAI,EAAE,QADY;AAElBC,YAAAA,WAAW,EAAE,mCAFK;AAGlBpB,YAAAA,EAAE,EAAE,QAHc;AAIlBqB,YAAAA,SAAS,EAAE,MAAI,CAACC,KAAL,CAAWnB,OAAX,GAAqB,SAArB,GAAiC,EAJ1B;AAKlBoB,YAAAA,QAAQ,EAAE,kBAAAnB,CAAC,EAAI;AACdA,cAAAA,CAAC,CAACoB,OAAF;;AACA,cAAA,MAAI,CAACD,QAAL,CAAcnB,CAAd,EAAiBC,MAAjB;AACA;AARiB,WAAF,CAFlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADM;AAAA,SADR,CADD,EAkBGW,MAAM,iBACP,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE,MAAI,CAACM,KAAL,CAAWpB,KAAX,CACCuB,GADD,CACK,UAAC7B,IAAD,EAAO8B,KAAP;AAAA,8BACL,oBAAC,YAAD,eACKX,YAAY,CAAC;AAAEnB,YAAAA,IAAI,EAAJA;AAAF,WAAD,CADjB;AAEC,YAAA,GAAG,EAAEA,IAAI,CAACI,EAFX;AAGC,YAAA,WAAW,EAAE0B,KAAK,KAClBR,gBAJD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAMC;AAAK,YAAA,KAAK,EAAC,IAAX;AAAgB,YAAA,GAAG,EAAEtB,IAAI,CAAC+B,KAA1B;AAAiC,YAAA,GAAG,EAAE/B,IAAI,CAACiB,KAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAND,EAOEjB,IAAI,CAACiB,KAPP,aAOqBjB,IAAI,CAACgC,QAP1B,CADK;AAAA,SADL,CADF,EAaE,CAAC,MAAI,CAACN,KAAL,CAAWpB,KAAX,CAAiB2B,MAAlB,IACA,CAAC,MAAI,CAACP,KAAL,CAAWnB,OADZ,iBACuB,oBAAC,YAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAA6Bc,UAA7B,CAdzB,CAnBF,CADE;AAAA,OADF,CADD,CADD;AA6CA;;;;EArEyBlC,KAAK,CAAC+C,S;;AAyEjC,eAAe7B,YAAf","sourcesContent":["import React from 'react'\r\nimport Link from 'next/link';\r\nimport Downshift, { resetIdCounter } from 'downshift';\r\nimport Router from 'next/router';\r\nimport { ApolloConsumer } from 'react-apollo';\r\nimport gql from 'graphql-tag';\r\nimport debounce from 'lodash.debounce';\r\nimport { DropDown, DropDownItem, SearchStyles } from './styles/DropDown';\r\n\r\n\r\n\r\nconst SEARCH_ITEMS_QUERY = gql`\r\n\tquery SEARCH_ITEMS_QUERY($searchTerm: String!) {\r\n\t\titems(where: { OR: [{ title_contains: $searchTerm }, { ageRange_contains: $searchTerm }] }) {\r\n\t\t\tid\r\n\t\t\timage\r\n\t\t\ttitle\r\n\t\t\tageRange\r\n\t\t}\r\n\t}\r\n`;\r\n\r\nfunction routeToItem(item) {\r\n\tRouter.push({\r\n\t\tpathname: '/item',\r\n\t\tquery: {\r\n\t\t\tid: item.id,\r\n\t\t},\r\n\t});\r\n}\r\n\r\nclass AutoComplete extends React.Component {\r\n\r\n\tstate = {\r\n\t\titems: [],\r\n\t\tloading: false,\r\n\r\n\t};\r\n\r\n\tonChange = debounce(async (e, client) => {\r\n\t\t// turn loading on\r\n\t\tthis.setState({ loading: true });\r\n\t\t// Manually query apollo client\r\n\t\tconst res = await client.query({\r\n\t\t\tquery: SEARCH_ITEMS_QUERY,\r\n\t\t\tvariables: { searchTerm: e.target.value },\r\n\t\t});\r\n\t\tthis.setState({\r\n\t\t\titems: res.data.items,\r\n\t\t\tloading: false,\r\n\t\t});\r\n\t}, 350);\r\n\trender (){\r\n\r\n\t\tresetIdCounter();\r\n\t\treturn (\r\n\t\t\t<SearchStyles>\r\n\t\t\t\t<Downshift onChange={routeToItem} itemToString={item => (item === null ? '' : item.title)}>\r\n\t\t\t\t\t{({getInputProps, getItemProps, isOpen, inputValue, highlightedIndex}) => (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<ApolloConsumer>\r\n\t\t\t\t\t\t{client => (\r\n\t\t\t\t\t\t\t<input \r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t{...getInputProps ({\r\n\t\t\t\t\t\t\t\t\ttype: 'search',\r\n\t\t\t\t\t\t\t\t\tplaceholder: \"Search for a book title or age...\",\r\n\t\t\t\t\t\t\t\t\tid: 'search',\r\n\t\t\t\t\t\t\t\t\tclassName: this.state.loading ? 'loading' : '', \r\n\t\t\t\t\t\t\t\t\tonChange: e => {\r\n\t\t\t\t\t\t\t\t\t\te.persist();\r\n\t\t\t\t\t\t\t\t\t\tthis.onChange(e, client);\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</ApolloConsumer>\r\n\t\t\t\t\t{ isOpen && (\r\n\t\t\t\t\t\t<DropDown>\r\n\t\t\t\t\t\t\t{this.state.items\r\n\t\t\t\t\t\t\t\t.map((item, index) => (\r\n\t\t\t\t\t\t\t\t<DropDownItem \r\n\t\t\t\t\t\t\t\t\t{...getItemProps({ item })}\r\n\t\t\t\t\t\t\t\t\tkey={item.id}\r\n\t\t\t\t\t\t\t\t\thighlighted={index ===\r\n\t\t\t\t\t\t\t\t\thighlightedIndex}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<img width=\"50\" src={item.image} alt={item.title} />\r\n\t\t\t\t\t\t\t\t\t{item.title} - Age {item.ageRange}\r\n\t\t\t\t\t\t\t\t</DropDownItem>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t{!this.state.items.length && \r\n\t\t\t\t\t\t\t !this.state.loading && <DropDownItem>Nothing Found {inputValue}</DropDownItem>}\r\n\t\t\t\t\t\t</DropDown>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t\t</Downshift>\r\n\t\t\t</SearchStyles>\r\n\t\t);\r\n\t}\r\n}\r\n\r\n\r\nexport default AutoComplete;"]},"metadata":{},"sourceType":"module"}